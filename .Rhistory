source('~/Desktop/MetaCC/MetaCC code/normcc.R')
normcc('contig_info.csv' , 'row_sum.csv')
normcc('contig_info.csv' , 'row_sum.csv')
normcc('contig_info_map2same.csv' , 'row_sum.csv')
source('~/Desktop/MetaCC/MetaCC code/normcc.R')
normcc('contig_info_map2same.csv' , 'row_sum.csv')
normcc('contig_info.csv' , 'row_sum.csv')
2.6435153 - 0.5*0.6912251
normcc = function(contig_info_file , row_sum_file)
{
row_sum_contact = read.csv(row_sum_file , sep = ',' , header  = F)
sampleCon = as.numeric(row_sum_contact[[1]])
contig_info = read.csv(contig_info_file , header = F , sep = ',' )
contig_info = as.data.frame(contig_info)
colnames(contig_info) = c('contig_name' , 'site' , 'length' , 'coverage')
contig_info[contig_info$coverage==0 , 4] = min(contig_info[contig_info$coverage!=0 , 4])
print(cor(contig_info[,2] , sampleCon))
print(cor(contig_info[,3] , sampleCon))
print(cor(contig_info[,4] , sampleCon))
data_sample = cbind((log(contig_info$site+1.01)) , (log(contig_info$length)) ,
(log(contig_info$cov/sqrt(contig_info$site+1.01*contig_info$length))) , sampleCon)
data_sample = as.data.frame(data_sample)
colnames(data_sample) = c('sample_site' , 'sample_len' , 'sample_cov', 'sampleCon')
tryCatch(
{
fit1 = glmmTMB(sampleCon~sample_site+sample_len+sample_cov, data = data_sample,
ziformula=~0 , family=nbinom2)
},
error = function(e){
message(e)
message(paste("\nskip",  sep=" "))
},
warning = function(w){
message(w)
message(paste("\nskip",  sep=" "))
}
)
coeff = as.numeric(fit1$fit$par)
result = c(coeff[1:4])
return(result)
}
normcc('contig_info_map2same.csv' , 'row_sum.csv')
normcc = function(contig_info_file , row_sum_file)
{
row_sum_contact = read.csv(row_sum_file , sep = ',' , header  = F)
sampleCon = as.numeric(row_sum_contact[[1]])
contig_info = read.csv(contig_info_file , header = F , sep = ',' )
contig_info = as.data.frame(contig_info)
colnames(contig_info) = c('contig_name' , 'site' , 'length' , 'coverage')
contig_info[ , 4] = contig_info[ , 4]/sqrt((contig_info[,2]+1.01)*contig_info[,3])
contig_info[contig_info$coverage==0 , 4] = min(contig_info[contig_info$coverage!=0 , 4])
print(cor(contig_info[,2] , sampleCon))
print(cor(contig_info[,3] , sampleCon))
print(cor(contig_info[,4] , sampleCon))
data_sample = cbind((log(contig_info$site+1.01)) , (log(contig_info$length)) ,
(log(contig_info$cov)) , sampleCon)
data_sample = as.data.frame(data_sample)
colnames(data_sample) = c('sample_site' , 'sample_len' , 'sample_cov', 'sampleCon')
tryCatch(
{
fit1 = glmmTMB(sampleCon~sample_site+sample_len+sample_cov, data = data_sample,
ziformula=~0 , family=nbinom2)
},
error = function(e){
message(e)
message(paste("\nskip",  sep=" "))
},
warning = function(w){
message(w)
message(paste("\nskip",  sep=" "))
}
)
coeff = as.numeric(fit1$fit$par)
result = c(coeff[1:4])
return(result)
}
normcc('contig_info_map2same.csv' , 'row_sum.csv')
normcc = function(contig_info_file , row_sum_file)
{
row_sum_contact = read.csv(row_sum_file , sep = ',' , header  = F)
sampleCon = as.numeric(row_sum_contact[[1]])
contig_info = read.csv(contig_info_file , header = F , sep = ',' )
contig_info = as.data.frame(contig_info)
colnames(contig_info) = c('contig_name' , 'site' , 'length' , 'coverage')
#contig_info[ , 4] = contig_info[ , 4]/sqrt((contig_info[,2]+1.01)*contig_info[,3])
contig_info[contig_info$coverage==0 , 4] = min(contig_info[contig_info$coverage!=0 , 4])
print(cor(contig_info[,2] , sampleCon))
print(cor(contig_info[,3] , sampleCon))
print(cor(contig_info[,4] , sampleCon))
data_sample = cbind((log(contig_info$site+1.01)) , (log(contig_info$length)) ,
(log(contig_info$cov)) , sampleCon)
data_sample = as.data.frame(data_sample)
colnames(data_sample) = c('sample_site' , 'sample_len' , 'sample_cov', 'sampleCon')
tryCatch(
{
fit1 = glmmTMB(sampleCon~sample_site+sample_len+sample_cov, data = data_sample,
ziformula=~0 , family=nbinom2)
},
error = function(e){
message(e)
message(paste("\nskip",  sep=" "))
},
warning = function(w){
message(w)
message(paste("\nskip",  sep=" "))
}
)
coeff = as.numeric(fit1$fit$par)
result = c(coeff[1:4])
return(result)
}
normcc('contig_info.csv' , 'row_sum.csv')
source('~/Desktop/MetaCC/MetaCC code/normcc.R')
normcc('contig_info_map2same.csv' , 'row_sum.csv')
source('~/Desktop/MetaCC/MetaCC code/normcc.R')
normcc('contig_info_map2same.csv' , 'row_sum.csv')
source('~/Desktop/MetaCC/MetaCC code/normcc.R')
normcc('contig_info_map2same.csv' , 'row_sum.csv')
normcc('contig_info.csv' , 'row_sum.csv')
normcc = function(contig_info_file , row_sum_file)
{
row_sum_contact = read.csv(row_sum_file , sep = ',' , header  = F)
sampleCon = as.numeric(row_sum_contact[[1]])
contig_info = read.csv(contig_info_file , header = F , sep = ',' )
contig_info = as.data.frame(contig_info)
colnames(contig_info) = c('contig_name' , 'site' , 'length' , 'coverage')
#contig_info[ , 4] = contig_info[ , 4]/sqrt((contig_info[,2]+1.01)*contig_info[,3])
#contig_info[contig_info$coverage==0 , 4] = min(contig_info[contig_info$coverage!=0 , 4])
print(cor(contig_info[,2] , sampleCon))
print(cor(contig_info[,3] , sampleCon))
print(cor(contig_info[,4] , sampleCon))
data_sample = cbind((log(contig_info$site+1.01)) , (log(contig_info$length)) ,
(log(contig_info$cov+0.001)) , sampleCon)
data_sample = as.data.frame(data_sample)
colnames(data_sample) = c('sample_site' , 'sample_len' , 'sample_cov', 'sampleCon')
tryCatch(
{
fit1 = glmmTMB(sampleCon~sample_site+sample_len+sample_cov, data = data_sample,
ziformula=~0 , family=nbinom2)
},
error = function(e){
message(e)
message(paste("\nskip",  sep=" "))
},
warning = function(w){
message(w)
message(paste("\nskip",  sep=" "))
}
)
coeff = as.numeric(fit1$fit$par)
result = c(coeff[1:4])
return(result)
}
normcc('contig_info_map2same.csv' , 'row_sum.csv')
normcc('contig_info.csv' , 'row_sum.csv')
normcc('contig_info_map2same.csv' , 'row_sum.csv')
normcc('contig_info.csv' , 'row_sum.csv')
normcc = function(contig_info_file , row_sum_file)
{
row_sum_contact = read.csv(row_sum_file , sep = ',' , header  = F)
sampleCon = as.numeric(row_sum_contact[[1]])
contig_info = read.csv(contig_info_file , header = F , sep = ',' )
contig_info = as.data.frame(contig_info)
colnames(contig_info) = c('contig_name' , 'site' , 'length' , 'coverage')
#contig_info[ , 4] = contig_info[ , 4]/sqrt((contig_info[,2]+1.01)*contig_info[,3])
contig_info[contig_info$coverage==0 , 4] = min(contig_info[contig_info$coverage!=0 , 4])
print(cor(contig_info[,2] , sampleCon))
print(cor(contig_info[,3] , sampleCon))
print(cor(contig_info[,4] , sampleCon))
data_sample = cbind((log(contig_info$site+1.01)) , (log(contig_info$length)) ,
(log(contig_info$cov)) , sampleCon)
data_sample = as.data.frame(data_sample)
colnames(data_sample) = c('sample_site' , 'sample_len' , 'sample_cov', 'sampleCon')
tryCatch(
{
fit1 = glmmTMB(sampleCon~sample_site+sample_len+sample_cov, data = data_sample,
ziformula=~0 , family=nbinom2)
},
error = function(e){
message(e)
message(paste("\nskip",  sep=" "))
},
warning = function(w){
message(w)
message(paste("\nskip",  sep=" "))
}
)
coeff = as.numeric(fit1$fit$par)
result = c(coeff[1:4])
return(result)
}
normcc('contig_info_map2same.csv' , 'row_sum.csv')
normcc('contig_info.csv' , 'row_sum.csv')
2.6435153 - 0.5*0.6912251
normcc = function(contig_info_file , row_sum_file)
{
row_sum_contact = read.csv(row_sum_file , sep = ',' , header  = F)
sampleCon = as.numeric(row_sum_contact[[1]])
contig_info = read.csv(contig_info_file , header = F , sep = ',' )
contig_info = as.data.frame(contig_info)
colnames(contig_info) = c('contig_name' , 'site' , 'length' , 'coverage')
contig_info[ , 4] = contig_info[ , 4]/sqrt((contig_info[,2]+1.01)*contig_info[,3])
contig_info[contig_info$coverage==0 , 4] = min(contig_info[contig_info$coverage!=0 , 4])
print(cor(contig_info[,2] , sampleCon))
print(cor(contig_info[,3] , sampleCon))
print(cor(contig_info[,4] , sampleCon))
data_sample = cbind((log(contig_info$site+1.01)) , (log(contig_info$length)) ,
(log(contig_info$cov)) , sampleCon)
data_sample = as.data.frame(data_sample)
colnames(data_sample) = c('sample_site' , 'sample_len' , 'sample_cov', 'sampleCon')
tryCatch(
{
fit1 = glmmTMB(sampleCon~sample_site+sample_len+sample_cov, data = data_sample,
ziformula=~0 , family=nbinom2)
},
error = function(e){
message(e)
message(paste("\nskip",  sep=" "))
},
warning = function(w){
message(w)
message(paste("\nskip",  sep=" "))
}
)
coeff = as.numeric(fit1$fit$par)
result = c(coeff[1:4])
return(result)
}
normcc('contig_info_map2same.csv' , 'row_sum.csv')
normcc('contig_info.csv' , 'row_sum.csv')
normcc = function(contig_info_file , row_sum_file)
{
row_sum_contact = read.csv(row_sum_file , sep = ',' , header  = F)
sampleCon = as.numeric(row_sum_contact[[1]])
contig_info = read.csv(contig_info_file , header = F , sep = ',' )
contig_info = as.data.frame(contig_info)
colnames(contig_info) = c('contig_name' , 'site' , 'length' , 'coverage')
index = contig_info$coverage>0
row_sum_contact = sampleCon[index]
contig_info = contig_info[index , ]
#contig_info[ , 4] = contig_info[ , 4]/sqrt((contig_info[,2]+1.01)*contig_info[,3])
#contig_info[contig_info$coverage==0 , 4] = min(contig_info[contig_info$coverage!=0 , 4])
print(cor(contig_info[,2] , sampleCon))
print(cor(contig_info[,3] , sampleCon))
print(cor(contig_info[,4] , sampleCon))
data_sample = cbind((log(contig_info$site+1.01)) , (log(contig_info$length)) ,
(log(contig_info$cov)) , sampleCon)
data_sample = as.data.frame(data_sample)
colnames(data_sample) = c('sample_site' , 'sample_len' , 'sample_cov', 'sampleCon')
tryCatch(
{
fit1 = glmmTMB(sampleCon~sample_site+sample_len+sample_cov, data = data_sample,
ziformula=~0 , family=nbinom2)
},
error = function(e){
message(e)
message(paste("\nskip",  sep=" "))
},
warning = function(w){
message(w)
message(paste("\nskip",  sep=" "))
}
)
coeff = as.numeric(fit1$fit$par)
result = c(coeff[1:4])
return(result)
}
normcc('contig_info_map2same.csv' , 'row_sum.csv')
normcc = function(contig_info_file , row_sum_file)
{
row_sum_contact = read.csv(row_sum_file , sep = ',' , header  = F)
sampleCon = as.numeric(row_sum_contact[[1]])
contig_info = read.csv(contig_info_file , header = F , sep = ',' )
contig_info = as.data.frame(contig_info)
colnames(contig_info) = c('contig_name' , 'site' , 'length' , 'coverage')
index = contig_info$coverage>0
sampleCon = sampleCon[index]
contig_info = contig_info[index , ]
#contig_info[ , 4] = contig_info[ , 4]/sqrt((contig_info[,2]+1.01)*contig_info[,3])
#contig_info[contig_info$coverage==0 , 4] = min(contig_info[contig_info$coverage!=0 , 4])
print(cor(contig_info[,2] , sampleCon))
print(cor(contig_info[,3] , sampleCon))
print(cor(contig_info[,4] , sampleCon))
data_sample = cbind((log(contig_info$site+1.01)) , (log(contig_info$length)) ,
(log(contig_info$cov)) , sampleCon)
data_sample = as.data.frame(data_sample)
colnames(data_sample) = c('sample_site' , 'sample_len' , 'sample_cov', 'sampleCon')
tryCatch(
{
fit1 = glmmTMB(sampleCon~sample_site+sample_len+sample_cov, data = data_sample,
ziformula=~0 , family=nbinom2)
},
error = function(e){
message(e)
message(paste("\nskip",  sep=" "))
},
warning = function(w){
message(w)
message(paste("\nskip",  sep=" "))
}
)
coeff = as.numeric(fit1$fit$par)
result = c(coeff[1:4])
return(result)
}
normcc('contig_info_map2same.csv' , 'row_sum.csv')
normcc('contig_info.csv' , 'row_sum.csv')
source('~/Desktop/MetaCC/MetaCC code/normcc.R')
1.4705813 - 0.5*0.9239893
-0.8902426 - 0.5* 0.9239893
normcc('contig_info_map2same.csv' , 'row_sum.csv')
normcc = function(contig_info_file , row_sum_file)
{
row_sum_contact = read.csv(row_sum_file , sep = ',' , header  = F)
sampleCon = as.numeric(row_sum_contact[[1]])
contig_info = read.csv(contig_info_file , header = F , sep = ',' )
contig_info = as.data.frame(contig_info)
colnames(contig_info) = c('contig_name' , 'site' , 'length' , 'coverage')
index = contig_info$coverage>0
sampleCon = sampleCon[index]
contig_info = contig_info[index , ]
contig_info[ , 4] = contig_info[ , 4]/sqrt((contig_info[,2]+1.01)*contig_info[,3])
#contig_info[contig_info$coverage==0 , 4] = min(contig_info[contig_info$coverage!=0 , 4])
print(cor(contig_info[,2] , sampleCon))
print(cor(contig_info[,3] , sampleCon))
print(cor(contig_info[,4] , sampleCon))
data_sample = cbind((log(contig_info$site+1.01)) , (log(contig_info$length)) ,
(log(contig_info$cov)) , sampleCon)
data_sample = as.data.frame(data_sample)
colnames(data_sample) = c('sample_site' , 'sample_len' , 'sample_cov', 'sampleCon')
tryCatch(
{
fit1 = glmmTMB(sampleCon~sample_site+sample_len+sample_cov, data = data_sample,
ziformula=~0 , family=nbinom2)
},
error = function(e){
message(e)
message(paste("\nskip",  sep=" "))
},
warning = function(w){
message(w)
message(paste("\nskip",  sep=" "))
}
)
coeff = as.numeric(fit1$fit$par)
result = c(coeff[1:4])
return(result)
}
normcc('contig_info_map2same.csv' , 'row_sum.csv')
normcc = function(contig_info_file , row_sum_file)
{
row_sum_contact = read.csv(row_sum_file , sep = ',' , header  = F)
sampleCon = as.numeric(row_sum_contact[[1]])
contig_info = read.csv(contig_info_file , header = F , sep = ',' )
contig_info = as.data.frame(contig_info)
colnames(contig_info) = c('contig_name' , 'site' , 'length' , 'coverage')
index = contig_info$coverage>0
sampleCon = sampleCon[index]
contig_info = contig_info[index , ]
#contig_info[ , 4] = contig_info[ , 4]/sqrt((contig_info[,2]+1.01)*contig_info[,3])
#contig_info[contig_info$coverage==0 , 4] = min(contig_info[contig_info$coverage!=0 , 4])
print(cor(contig_info[,2] , sampleCon))
print(cor(contig_info[,3] , sampleCon))
print(cor(contig_info[,4] , sampleCon))
data_sample = cbind((log(contig_info$site+1.01)) , (log(contig_info$length)) ,
(log(contig_info$cov)) , sampleCon)
data_sample = as.data.frame(data_sample)
colnames(data_sample) = c('sample_site' , 'sample_len' , 'sample_cov', 'sampleCon')
tryCatch(
{
fit1 = glmmTMB(sampleCon~sample_site+sample_len+sample_cov, data = data_sample,
ziformula=~0 , family=nbinom2)
},
error = function(e){
message(e)
message(paste("\nskip",  sep=" "))
},
warning = function(w){
message(w)
message(paste("\nskip",  sep=" "))
}
)
coeff = as.numeric(fit1$fit$par)
result = c(coeff[1:4])
return(result)
}
normcc('contig_info.csv' , 'row_sum.csv')
source('~/Desktop/MetaCC/MetaCC code/normcc.R')
contig_info = read.csv('contig_info.csv' , header = F , sep = ',' )
sum(contig_info[,4]==0)
View(contig_info)
contig_info = read.csv('contig_info_map2same.csv' , header = F , sep = ',' )
View(contig_info)
sum(contig_info[,4]==0)
min(contig_info[contig_info[,4]>0,4])
source('~/Desktop/MetaCC/MetaCC code/normcc.R')
